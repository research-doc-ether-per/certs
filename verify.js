let sql  = 'WITH dates AS (';
sql     += '  SELECT group_id, type,';
sql     += '         MIN(create_date) AS create_date,';
sql     += '         MAX(update_date) AS update_date';
sql     += '    FROM (';
sql     += '      SELECT group_id, type, create_date, update_date';
sql     += '        FROM status_list';
sql     += '       WHERE group_id = $1';
sql     += '      UNION ALL';
sql     += '      SELECT group_id, type, NULL::timestamp AS create_date, update_date';
sql     += '        FROM status_list_user';
sql     += '       WHERE group_id = $1';
sql     += '    ) t';
sql     += '   GROUP BY group_id, type';
sql     += ') ';
sql     += 'SELECT DISTINCT ON (sl.type) ';
sql     += '  sl.group_id,';
sql     += '  sl.type,';
sql     += '  sl.status_list_credential_url,';
sql     += '  d.create_date,';
sql     += '  d.update_date ';
sql     += 'FROM status_list sl ';
sql     += 'JOIN dates d ';
sql     += '  ON d.group_id = sl.group_id ';
sql     += ' AND d.type     = sl.type ';
sql     += 'WHERE sl.group_id = $1 ';
sql     += 'ORDER BY sl.type, sl.create_date DESC';

